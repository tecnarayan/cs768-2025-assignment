A Flexible Framework for Designing Trainable Priors with Adaptive Smoothing and Game Encoding