Solving Marginal MAP Problems with NP Oracles and Parity Constraints