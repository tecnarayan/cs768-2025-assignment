Graph-based Isometry Invariant Representation Learning