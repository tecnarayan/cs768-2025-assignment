Heterogeneous Multi-player Multi-armed Bandits: Closing the Gap and Generalization