Near optimal Representation Learning for Linear Bandits and Linear RL