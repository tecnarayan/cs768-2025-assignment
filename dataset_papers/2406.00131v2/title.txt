From Unstructured Data to In-Context Learning: Exploring What Tasks Can Be Learned and When