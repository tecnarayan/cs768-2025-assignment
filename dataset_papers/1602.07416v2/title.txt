Learning to Generate with Memory