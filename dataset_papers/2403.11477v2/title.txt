Span-Based Optimal Sample Complexity for Weakly Communicating and General Average Reward MDPs