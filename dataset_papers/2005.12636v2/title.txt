Hard Shape-Constrained Kernel Machines