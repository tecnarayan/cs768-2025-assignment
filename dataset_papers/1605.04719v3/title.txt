Optimal Tagging with Markov Chain Optimization