Learning Local Invariant Mahalanobis Distances