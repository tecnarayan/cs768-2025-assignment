Optimizing Non-decomposable Performance Measures: A Tale of Two Classes