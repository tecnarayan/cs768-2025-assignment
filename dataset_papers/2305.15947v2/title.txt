Online learning of long-range dependencies