Consistent estimation of dynamic and multi-layer block models