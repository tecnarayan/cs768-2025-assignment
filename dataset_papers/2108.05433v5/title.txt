Learning to Hash Robustly, Guaranteed