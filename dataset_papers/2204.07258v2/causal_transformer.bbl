\begin{thebibliography}{62}
\providecommand{\natexlab}[1]{#1}
\providecommand{\url}[1]{\texttt{#1}}
\expandafter\ifx\csname urlstyle\endcsname\relax
  \providecommand{\doi}[1]{doi: #1}\else
  \providecommand{\doi}{doi: \begingroup \urlstyle{rm}\Url}\fi

\bibitem[Alaa \& van~der Schaar(2018{\natexlab{a}})Alaa and van~der
  Schaar]{alaa2018limits}
Alaa, A. and van~der Schaar, M.
\newblock Limits of estimating heterogeneous treatment effects: Guidelines for
  practical algorithm design.
\newblock In \emph{International Conference on Machine Learning},
  2018{\natexlab{a}}.

\bibitem[Alaa \& van~der Schaar(2018{\natexlab{b}})Alaa and van~der
  Schaar]{alaa2018bayesian}
Alaa, A.~M. and van~der Schaar, M.
\newblock Bayesian nonparametric causal inference: Information rates and
  learning algorithms.
\newblock \emph{IEEE Journal of Selected Topics in Signal Processing},
  12\penalty0 (5):\penalty0 1031--1046, 2018{\natexlab{b}}.

\bibitem[Allam et~al.(2021)Allam, Feuerriegel, Rebhan, Krauthammer,
  et~al.]{allam2021analyzing}
Allam, A., Feuerriegel, S., Rebhan, M., Krauthammer, M., et~al.
\newblock Analyzing patient trajectories with artificial intelligence.
\newblock \emph{Journal of Medical Internet Research}, 23\penalty0
  (12):\penalty0 e29812, 2021.

\bibitem[Atan et~al.(2018{\natexlab{a}})Atan, Zame, and van~der
  Schaar]{atan2018counterfactual}
Atan, O., Zame, W.~R., and van~der Schaar, M.
\newblock Counterfactual policy optimization using domain-adversarial neural
  networks.
\newblock In \emph{ICML CausalML Workshop}, 2018{\natexlab{a}}.

\bibitem[Atan et~al.(2018{\natexlab{b}})Atan, Zame, and van~der
  Schaar]{atan2018learning}
Atan, O., Zame, W.~R., and van~der Schaar, M.
\newblock Learning optimal policies from observational data.
\newblock \emph{arXiv preprint arXiv:1802.08679}, 2018{\natexlab{b}}.

\bibitem[Ba et~al.(2016)Ba, Kiros, and Hinton]{lei2016layer}
Ba, J.~L., Kiros, J.~R., and Hinton, G.~E.
\newblock Layer normalization.
\newblock \emph{arXiv preprint arXiv:1607.06450}, 2016.

\bibitem[Berrevoets et~al.(2021)Berrevoets, Curth, Bica, McKinney, and van~der
  Schaar]{berrevoets2021disentangled}
Berrevoets, J., Curth, A., Bica, I., McKinney, E., and van~der Schaar, M.
\newblock Disentangled counterfactual recurrent networks for treatment effect
  inference over time.
\newblock \emph{arXiv preprint arXiv:2112.03811}, 2021.

\bibitem[Bica et~al.(2020)Bica, Alaa, Jordon, and van~der
  Schaar]{bica2020estimating}
Bica, I., Alaa, A.~M., Jordon, J., and van~der Schaar, M.
\newblock Estimating counterfactual treatment outcomes over time through
  adversarially balanced representations.
\newblock 2020.

\bibitem[Brown et~al.(2020)Brown, Mann, Ryder, Subbiah, Kaplan, Dhariwal,
  Neelakantan, Shyam, Sastry, Askell, Agarwal, Herbert-Voss, Krueger, Henighan,
  Child, Ramesh, Ziegler, Wu, Winter, Hesse, Chen, Sigler, Litwin, Gray, Chess,
  Clark, Berner, McCandlish, Radford, Sutskever, and Amodei]{brown2020language}
Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J.~D., Dhariwal, P.,
  Neelakantan, A., Shyam, P., Sastry, G., Askell, A., Agarwal, S.,
  Herbert-Voss, A., Krueger, G., Henighan, T., Child, R., Ramesh, A., Ziegler,
  D., Wu, J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M., Gray,
  S., Chess, B., Clark, J., Berner, C., McCandlish, S., Radford, A., Sutskever,
  I., and Amodei, D.
\newblock Language models are few-shot learners.
\newblock In \emph{Advances in Neural Information Processing Systems}, 2020.

\bibitem[Chipman et~al.(2010)Chipman, George, and McCulloch]{chipman2010bart}
Chipman, H.~A., George, E.~I., and McCulloch, R.~E.
\newblock {BART}: Bayesian additive regression trees.
\newblock \emph{The Annals of Applied Statistics}, 4\penalty0 (1):\penalty0
  266--298, 2010.

\bibitem[Curth \& van~der Schaar(2021)Curth and van~der
  Schaar]{curth2021nonparametric}
Curth, A. and van~der Schaar, M.
\newblock Nonparametric estimation of heterogeneous treatment effects: From
  theory to learning algorithms.
\newblock In \emph{International Conference on Artificial Intelligence and
  Statistics}, 2021.

\bibitem[Devlin et~al.(2019)Devlin, Chang, Lee, and Toutanova]{devlin2019bert}
Devlin, J., Chang, M., Lee, K., and Toutanova, K.
\newblock {BERT}: Pre-training of deep bidirectional transformers for language
  understanding.
\newblock In \emph{Conference of the North American Chapter of the Association
  for Computational Linguistics: Human Language Technologies}, 2019.

\bibitem[Dong et~al.(2021)Dong, Cordonnier, and Loukas]{dong2021attention}
Dong, Y., Cordonnier, J.-B., and Loukas, A.
\newblock Attention is not all you need: Pure attention loses rank doubly
  exponentially with depth.
\newblock In \emph{International Conference on Machine Learning}, 2021.

\bibitem[Dosovitskiy et~al.(2020)Dosovitskiy, Beyer, Kolesnikov, Weissenborn,
  Zhai, Unterthiner, Dehghani, Minderer, Heigold, Gelly,
  et~al.]{dosovitskiy2020image}
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X.,
  Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et~al.
\newblock An image is worth 16x16 words: Transformers for image recognition at
  scale.
\newblock In \emph{International Conference on Learning Representations}, 2020.

\bibitem[Frauen et~al.(2022)Frauen, Hatt, Melnychuk, and
  Feuerriegel]{frauen2022estimating}
Frauen, D., Hatt, T., Melnychuk, V., and Feuerriegel, S.
\newblock Estimating average causal effects from patient trajectories.
\newblock \emph{arXiv preprint arXiv:2203.01228}, 2022.

\bibitem[Ganin \& Lempitsky(2015)Ganin and Lempitsky]{ganin2015unsupervised}
Ganin, Y. and Lempitsky, V.
\newblock Unsupervised domain adaptation by backpropagation.
\newblock In \emph{International Conference on Machine Learning}, 2015.

\bibitem[Geng et~al.(2017)Geng, Paganetti, and Grassberger]{geng2017prediction}
Geng, C., Paganetti, H., and Grassberger, C.
\newblock Prediction of treatment response for combined chemo-and radiation
  therapy for non-small cell lung cancer patients using a bio-mathematical
  model.
\newblock \emph{Scientific Reports}, 7\penalty0 (1):\penalty0 Article 13542,
  2017.

\bibitem[Hatt \& Feuerriegel(2021)Hatt and Feuerriegel]{hatt2021sequential}
Hatt, T. and Feuerriegel, S.
\newblock Sequential deconfounding for causal inference with unobserved
  confounders.
\newblock \emph{arXiv preprint arXiv:2104.09323}, 2021.

\bibitem[Hensman et~al.(2017)Hensman, Durrande, Solin,
  et~al.]{hensman2017variational}
Hensman, J., Durrande, N., Solin, A., et~al.
\newblock Variational {F}ourier features for {G}aussian processes.
\newblock \emph{Journal of Machine Learning Research}, 18\penalty0
  (1):\penalty0 5537--5588, 2017.

\bibitem[Hern{\'a}n et~al.(2001)Hern{\'a}n, Brumback, and
  Robins]{hernan2001marginal}
Hern{\'a}n, M.~A., Brumback, B., and Robins, J.~M.
\newblock Marginal structural models to estimate the joint causal effect of
  nonrandomized treatments.
\newblock \emph{Journal of the American Statistical Association}, 96\penalty0
  (454):\penalty0 440--448, 2001.

\bibitem[Hill \& Su(2013)Hill and Su]{hill2013assessing}
Hill, J. and Su, Y.-S.
\newblock Assessing lack of common support in causal inference using {B}ayesian
  nonparametrics: Implications for evaluating the effect of breastfeeding on
  children's cognitive outcomes.
\newblock \emph{The Annals of Applied Statistics}, 7:\penalty0 1386--1420,
  2013.

\bibitem[Huang \& Ning(2012)Huang and Ning]{huang2012analysis}
Huang, X. and Ning, J.
\newblock Analysis of multi-stage treatments for recurrent diseases.
\newblock \emph{Statistics in Medicine}, 31\penalty0 (24):\penalty0 2805--2821,
  2012.

\bibitem[Jacobson et~al.(2013)Jacobson, Braffett, Cleary, Gubitosi-Klug,
  Larkin, and research group]{jacobson2013long}
Jacobson, A.~M., Braffett, B.~H., Cleary, P.~A., Gubitosi-Klug, R.~A., Larkin,
  M.~E., and research group, D.
\newblock The long-term effects of type 1 diabetes treatment and complications
  on health-related quality of life: a 23-year follow-up of the diabetes
  control and complications/epidemiology of diabetes interventions and
  complications cohort.
\newblock \emph{Diabetes Care}, 36\penalty0 (10):\penalty0 3131--3138, 2013.

\bibitem[Johansson et~al.(2016)Johansson, Shalit, and
  Sontag]{johansson2016learning}
Johansson, F., Shalit, U., and Sontag, D.
\newblock Learning representations for counterfactual inference.
\newblock In \emph{International Conference on Machine Learning}, 2016.

\bibitem[Johnson et~al.(2016)Johnson, Pollard, Shen, Li-Wei, Feng, Ghassemi,
  Moody, Szolovits, Celi, and Mark]{johnson2016mimic}
Johnson, A.~E., Pollard, T.~J., Shen, L., Li-Wei, H.~L., Feng, M., Ghassemi,
  M., Moody, B., Szolovits, P., Celi, L.~A., and Mark, R.~G.
\newblock {MIMIC-III}: A freely accessible critical care database.
\newblock \emph{Scientific Data}, 3\penalty0 (1):\penalty0 Article 160035,
  2016.

\bibitem[Kingma \& Ba(2015)Kingma and Ba]{kingma2014adam}
Kingma, D.~P. and Ba, J.
\newblock Adam: {A} method for stochastic optimization.
\newblock In \emph{International Conference on Learning Representations}, 2015.

\bibitem[Kuzmanovic et~al.(2021)Kuzmanovic, Hatt, and
  Feuerriegel]{kuzmanovic2021deconfounding}
Kuzmanovic, M., Hatt, T., and Feuerriegel, S.
\newblock Deconfounding temporal autoencoder: estimating treatment effects over
  time using noisy proxies.
\newblock In \emph{Machine Learning for Health}, 2021.

\bibitem[Kuzmanovic et~al.(2022)Kuzmanovic, Hatt, and
  Feuerriegel]{kuzmanovic2022estimating}
Kuzmanovic, M., Hatt, T., and Feuerriegel, S.
\newblock Estimating conditional average treatment effects with missing
  treatment information.
\newblock \emph{arXiv preprint arXiv:2203.01422}, 2022.

\bibitem[Latner et~al.(2000)Latner, Stunkard, Wilson, Jackson, Zelitch, and
  Labouvie]{latner2000effective}
Latner, J., Stunkard, A., Wilson, G., Jackson, M., Zelitch, D., and Labouvie,
  E.
\newblock Effective long-term treatment of obesity: a continuing care model.
\newblock \emph{International Journal of Obesity}, 24\penalty0 (7):\penalty0
  893--898, 2000.

\bibitem[Li et~al.(2021)Li, Shahn, Li, Lu, Chakraborty, Sow, Ghalwash, and
  Lehman]{li2021g}
Li, R., Shahn, Z., Li, J., Lu, M., Chakraborty, P., Sow, D., Ghalwash, M., and
  Lehman, L.-W.~H.
\newblock {G-Net}: A deep learning approach to {G}-computation for
  counterfactual outcome prediction under dynamic treatment regimes.
\newblock In \emph{Machine Learning for Health}, 2021.

\bibitem[Libovick{\'y} et~al.(2018)Libovick{\'y}, Helcl, and
  Mare{\v{c}}ek]{libovicky2018input}
Libovick{\'y}, J., Helcl, J., and Mare{\v{c}}ek, D.
\newblock Input combination strategies for multi-source transformer decoder.
\newblock In \emph{Conference on Machine Translation}, 2018.

\bibitem[Lim et~al.(2018)Lim, Alaa, and van~der Schaar]{lim2018forecasting}
Lim, B., Alaa, A., and van~der Schaar, M.
\newblock Forecasting treatment responses over time using recurrent marginal
  structural networks.
\newblock \emph{Advances in Neural Information Processing Systems}, 2018.

\bibitem[Liu et~al.(2021)Liu, Chen, Guo, Zhu, and Liu]{liu2021cptr}
Liu, W., Chen, S., Guo, L., Zhu, X., and Liu, J.
\newblock {CPTR}: Full transformer network for image captioning.
\newblock \emph{arXiv preprint arXiv:2101.10804}, 2021.

\bibitem[Liu et~al.(2019)Liu, Ott, Goyal, Du, Joshi, Chen, Levy, Lewis,
  Zettlemoyer, and Stoyanov]{liu2019roberta}
Liu, Y., Ott, M., Goyal, N., Du, J., Joshi, M., Chen, D., Levy, O., Lewis, M.,
  Zettlemoyer, L., and Stoyanov, V.
\newblock {RoBERTa}: A robustly optimized {BERT} pretraining approach.
\newblock \emph{arXiv preprint arXiv:1907.11692}, 2019.

\bibitem[Lu et~al.(2021)Lu, Grover, Abbeel, and Mordatch]{lu2021pretrained}
Lu, K., Grover, A., Abbeel, P., and Mordatch, I.
\newblock Pretrained transformers as universal computation engines.
\newblock \emph{arXiv preprint arXiv:2103.05247}, 2021.

\bibitem[Neyman(1923)]{neyman1923application}
Neyman, J.~S.
\newblock On the application of probability theory to agricultural experiments.
\newblock \emph{Annals of Agricultural Sciences}, 10:\penalty0 1--51, 1923.

\bibitem[Qian et~al.(2021)Qian, Zhang, Bica, Wood, and van~der
  Schaar]{qian2021synctwin}
Qian, Z., Zhang, Y., Bica, I., Wood, A., and van~der Schaar, M.
\newblock {SyncTwin}: Treatment effect estimation with longitudinal outcomes.
\newblock In \emph{Advances in Neural Information Processing Systems}, 2021.

\bibitem[Robins(1986)]{robins1986new}
Robins, J.
\newblock A new approach to causal inference in mortality studies with a
  sustained exposure period: Application to control of the healthy worker
  survivor effect.
\newblock \emph{Mathematical Modelling}, 7\penalty0 (9-12):\penalty0
  1393--1512, 1986.

\bibitem[Robins \& Hern{\'a}n(2009)Robins and Hern{\'a}n]{robins2009estimation}
Robins, J.~M. and Hern{\'a}n, M.~A.
\newblock \emph{Estimation of the causal effects of time-varying exposures}.
\newblock CRC Press, Boca Raton, FL, 2009.

\bibitem[Robins et~al.(2000)Robins, Hernan, and Brumback]{robins2000marginal}
Robins, J.~M., Hernan, M.~A., and Brumback, B.
\newblock Marginal structural models and causal inference in epidemiology,
  2000.

\bibitem[Rubin(1978)]{rubin1978bayesian}
Rubin, D.~B.
\newblock Bayesian inference for causal effects: The role of randomization.
\newblock \emph{The Annals of Statistics}, pp.\  34--58, 1978.

\bibitem[Schlag et~al.(2019)Schlag, Smolensky, Fernandez, Jojic, Schmidhuber,
  and Gao]{schlag2019enhancing}
Schlag, I., Smolensky, P., Fernandez, R., Jojic, N., Schmidhuber, J., and Gao,
  J.
\newblock Enhancing the transformer with explicit relational encoding for math
  problem solving.
\newblock \emph{arXiv preprint arXiv:1910.06611}, 2019.

\bibitem[Schulam \& Saria(2017)Schulam and Saria]{schulam2017reliable}
Schulam, P. and Saria, S.
\newblock Reliable decision support using counterfactual models.
\newblock \emph{Advances in Neural Information Processing Systems}, 2017.

\bibitem[Shaw et~al.(2018)Shaw, Uszkoreit, and Vaswani]{shaw2018self}
Shaw, P., Uszkoreit, J., and Vaswani, A.
\newblock Self-attention with relative position representations.
\newblock In \emph{Conference of the North {A}merican Chapter of the
  Association for Computational Linguistics: Human Language Technologies},
  2018.

\bibitem[Soleimani et~al.(2017)Soleimani, Subbaswamy, and
  Saria]{soleimani2017treatment}
Soleimani, H., Subbaswamy, A., and Saria, S.
\newblock Treatment-response models for counterfactual reasoning with
  continuous-time, continuous-valued interventions.
\newblock In \emph{Uncertainty in Artificial Intelligence}, 2017.

\bibitem[Sormani \& Bruzzi(2015)Sormani and Bruzzi]{sormani2015can}
Sormani, M.~P. and Bruzzi, P.
\newblock Can we measure long-term treatment effects in multiple sclerosis?
\newblock \emph{Nature Reviews Neurology}, 11\penalty0 (3):\penalty0 176--182,
  2015.

\bibitem[Srivastava et~al.(2014)Srivastava, Hinton, Krizhevsky, Sutskever, and
  Salakhutdinov]{srivastava2014dropout}
Srivastava, N., Hinton, G., Krizhevsky, A., Sutskever, I., and Salakhutdinov,
  R.
\newblock Dropout: A simple way to prevent neural networks from overfitting.
\newblock \emph{Journal of Machine Learning Research}, 15\penalty0
  (1):\penalty0 1929--1958, 2014.

\bibitem[Subramanian et~al.(2008)Subramanian, Yilmaz, Rehman, Hubmayr, Afessa,
  and Gajic]{subramanian2008liberal}
Subramanian, S., Yilmaz, M., Rehman, A., Hubmayr, R.~D., Afessa, B., and Gajic,
  O.
\newblock Liberal vs. conservative vasopressor use to maintain mean arterial
  blood pressure during resuscitation of septic shock: an observational study.
\newblock \emph{Intensive Care Medicine}, 34\penalty0 (1):\penalty0 157--162,
  2008.

\bibitem[Tang \& Matteson(2021)Tang and Matteson]{tang2021probabilistic}
Tang, B. and Matteson, D.
\newblock Probabilistic transformer for time series analysis.
\newblock \emph{Advances in Neural Information Processing Systems}, 2021.

\bibitem[Tzeng et~al.(2015)Tzeng, Hoffman, Darrell, and
  Saenko]{tzeng2015simultaneous}
Tzeng, E., Hoffman, J., Darrell, T., and Saenko, K.
\newblock Simultaneous deep transfer across domains and tasks.
\newblock In \emph{IEEE International Conference on Computer Vision}, 2015.

\bibitem[Tzeng et~al.(2017)Tzeng, Hoffman, Saenko, and
  Darrell]{tzeng2017adversarial}
Tzeng, E., Hoffman, J., Saenko, K., and Darrell, T.
\newblock Adversarial discriminative domain adaptation.
\newblock In \emph{IEEE Conference on Computer Vision and Pattern Recognition},
  2017.

\bibitem[van~der Laan \& Rubin(2006)van~der Laan and Rubin]{van2006targeted}
van~der Laan, M.~J. and Rubin, D.
\newblock Targeted maximum likelihood learning.
\newblock \emph{The International Journal of Biostatistics}, 2\penalty0
  (1):\penalty0 Article 11, 2006.

\bibitem[Vaswani et~al.(2017)Vaswani, Shazeer, Parmar, Uszkoreit, Jones, Gomez,
  Kaiser, and Polosukhin]{vaswani2017attention}
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.~N.,
  Kaiser, {\L}., and Polosukhin, I.
\newblock Attention is all you need.
\newblock In \emph{Advances in Neural Information Processing Systems}, 2017.

\bibitem[Vincent et~al.(2018)Vincent, Nielsen, Shapiro, Gerbasi, Grossman,
  Doroff, Zeng, Young, and Russell]{vincent2018mean}
Vincent, J.-L., Nielsen, N.~D., Shapiro, N.~I., Gerbasi, M.~E., Grossman, A.,
  Doroff, R., Zeng, F., Young, P.~J., and Russell, J.~A.
\newblock Mean arterial pressure and mortality in patients with distributive
  shock: a retrospective analysis of the {MIMIC-III} database.
\newblock \emph{Annals of Intensive Care}, 8\penalty0 (1):\penalty0 1--10,
  2018.

\bibitem[Wager \& Athey(2018)Wager and Athey]{wager2018estimation}
Wager, S. and Athey, S.
\newblock Estimation and inference of heterogeneous treatment effects using
  random forests.
\newblock \emph{Journal of the American Statistical Association}, 113\penalty0
  (523):\penalty0 1228--1242, 2018.

\bibitem[Wang et~al.(2020)Wang, McDermott, Chauhan, Ghassemi, Hughes, and
  Naumann]{wang2020mimic}
Wang, S., McDermott, M.~B., Chauhan, G., Ghassemi, M., Hughes, M.~C., and
  Naumann, T.
\newblock {MIMIC}-extract: A data extraction, preprocessing, and representation
  pipeline for {MIMIC-III}.
\newblock In \emph{ACM Conference on Health, Inference, and Learning}, 2020.

\bibitem[Williams \& Zipser(1989)Williams and Zipser]{williams1989learning}
Williams, R.~J. and Zipser, D.
\newblock A learning algorithm for continually running fully recurrent neural
  networks.
\newblock \emph{Neural Computation}, 1\penalty0 (2):\penalty0 270--280, 1989.

\bibitem[Xu et~al.(2016)Xu, Xu, and Saria]{Xu16}
Xu, Y., Xu, Y., and Saria, S.
\newblock A non-parametric {B}ayesian approach for estimating
  treatment-response curves from sparse time series.
\newblock In \emph{Machine Learning for Health}, 2016.

\bibitem[Yaz et~al.(2018)Yaz, Foo, Winkler, Yap, Piliouras, Chandrasekhar,
  et~al.]{yaz2018unusual}
Yaz, Y., Foo, C.-S., Winkler, S., Yap, K.-H., Piliouras, G., Chandrasekhar, V.,
  et~al.
\newblock The unusual effectiveness of averaging in {GAN} training.
\newblock In \emph{International Conference on Learning Representations}, 2018.

\bibitem[Yoon et~al.(2018)Yoon, Jordon, and van~der Schaar]{yoon2018ganite}
Yoon, J., Jordon, J., and van~der Schaar, M.
\newblock {GANITE}: Estimation of individualized treatment effects using
  generative adversarial nets.
\newblock In \emph{International Conference on Learning Representations}, 2018.

\bibitem[Zehui et~al.(2019)Zehui, Liu, Huang, Chen, Qiu, and
  Huang]{zehui2019dropattention}
Zehui, L., Liu, P., Huang, L., Chen, J., Qiu, X., and Huang, X.
\newblock {DropAttention}: A regularization method for fully-connected
  self-attention networks.
\newblock \emph{arXiv preprint arXiv:1907.11065}, 2019.

\bibitem[Zhou et~al.(2021)Zhou, Zhang, Peng, Zhang, Li, Xiong, and
  Zhang]{zhou2021informer}
Zhou, H., Zhang, S., Peng, J., Zhang, S., Li, J., Xiong, H., and Zhang, W.
\newblock Informer: Beyond efficient transformer for long sequence time-series
  forecasting.
\newblock In \emph{Association for the Advancement of Artificial Intelligence},
  2021.

\end{thebibliography}
