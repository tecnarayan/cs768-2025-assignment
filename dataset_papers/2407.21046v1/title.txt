Promises and Pitfalls of Generative Masked Language Modeling: Theoretical Framework and Practical Guidelines